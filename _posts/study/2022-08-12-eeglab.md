---
layout: post
title: '[EEG] EEG Preprocessing in EEGLAB'
subtitle: EEGLAB
date: '2022-08-12'
categories:
    - study
tags:
    - eeg
related_posts: 
    - _posts/study/2021-03-05-understanding_eeg.md
    - _posts/study/2022-07-12-re-referencing.md
comments: true
published: true
last_modified_at: '2022-08-12'
---

Matlab 기반의 무료 소프트웨어 EEGLAB의 사용법에 대해서 알아보고자 합니다.

* this unordered seed list will be replaced by the toc
{:toc}


## Installing EEGLAB

***

기존에는 python을 사용하여 EEG data의 전처리 및 분석을 진행하였으므로, python 기반 라이브러리 MNE를 주로 사용하였습니다. 그러나 MNE로 REC 파일（*.REC 또는 *.rec)을 읽는 방법을 찾지 못하여 EEGLAB을 사용하고자 합니다. MNE를 통해 REC 파일 읽는 방법을 아신다면 댓글 또는 이메일 주시면 감사하겠습니다.   
{:.faded}

* Environment
    + Windows 10


### Download MATLAB and EEGLAB

***

EEGLAB은 MATLAB 기반 프로그램이므로 MATLAB을 설치해야 합니다.
MATLAB은 유료로 이용하게 되면 가격이 상당합니다. **대학교 재학 중이거나 회사에서 지원하는 경우 무료**로 사용 가능하며, **30일 동안 평가판을 체험**할 수 있습니다. MATLAB 설치는 [MathWorks](https://kr.mathworks.com/campaigns/products/trials.html)에서 진행하면 됩니다.

![MATLAB](https://cdn.jsdelivr.net/gh/HayoonSong/Images-for-Github-Pages/study/eeg/2022-08-12-eeglab/matlab.PNG?raw=true)   
MATLAB 설치 방법
{:.figure}   

MATLAB 설치를 완료하였다면 [SCCN](https://sccn.ucsd.edu/eeglab/download.php)에서 EEGLAB을 설치하면 됩니다.   

![EEGLAB](https://cdn.jsdelivr.net/gh/HayoonSong/Images-for-Github-Pages/study/eeg/2022-08-12-eeglab/eeglab.PNG?raw=true)   
EEGLAB 설치 방법
{:.figure}   

EEGLAB 프로그램을 다운받기 위해서 **성명 및 이메일은 필수**로 기입하셔야 하며 연구분야의 경우 기입하지 않아도 괜찮습니다. 마지막으로 이메일로 소식을 받길 희망하는 분은 원하는 체크박스를 누르면 되며, **마지막 체크박스인 "I accept the terms of the BSD license."를 체크**하시며 됩니다.EEGLAB 파일은 이메일로 오는 것이 아니라, 성명과 이메일만 기입하면 **자동으로 로컬에 다운로드** 됩니다.   

![EEGLAB](https://cdn.jsdelivr.net/gh/HayoonSong/Images-for-Github-Pages/study/eeg/2022-08-12-eeglab/eeglab_description.PNG?raw=true)   
EEGLAB 프로그램 다운
{:.figure}   

첫 번째 상자인 Click here을 선택하면, 가장 최신 버전의 EEGLAB을 다운받을 수 있습니다. 만약, Matlab 2016a 버전 또는 더 이전 버전을 사용하고 있다면 두 번째 상자인 here에서 EEGLAB v2020.0을 다운받으면 됩니다.   

저는 MATLAB R2021b를 사용하고 있어서 Click here에서 가장 최신 버전의 EEGLAB을 다운받았습니다.   

![EEGLAB](https://cdn.jsdelivr.net/gh/HayoonSong/Images-for-Github-Pages/study/eeg/2022-08-12-eeglab/eeglab_path.PNG?raw=true)   
EEGLAB 저장
{:.figure}   

다운받은 압축파일을 풀고 평소에 프로그램을 저장하는 디렉토리로 이동시킵니다. 저는 주로 프로그램은 C드라이브 Program Files에 저장하여 이곳으로 옮겼습니다.

### Start MATLAB

***

Matlab을 실행하고 EEGLAB 프로그램이 있는 경로로 이동하여 **선택한 폴더 및 하위폴더를 경로에 추가**합니다.   

![EEGLAB](https://cdn.jsdelivr.net/gh/HayoonSong/Images-for-Github-Pages/study/eeg/2022-08-12-eeglab/eeglab_add_path.PNG?raw=true)   
EEGLAB 경로 추가
{:.figure}   

### Start EEGLAB

***

Matlba 명령 창 (command window)에 "eeglab"을 타이핑하면 됩니다.

![EEGLAB](https://cdn.jsdelivr.net/gh/HayoonSong/Images-for-Github-Pages/study/eeg/2022-08-12-eeglab/eeglab_start.PNG?raw=true)   
EEGLAB 실행
{:.figure}

다음과 같은 화면이 나오면 성공입니다.

![EEGLAB](https://cdn.jsdelivr.net/gh/HayoonSong/Images-for-Github-Pages/study/eeg/2022-08-12-eeglab/eeglab_main.PNG?raw=true)   
EEGLAB 실행 화면
{:.figure}

## Preprocessing EEG data

***

EEGLAB 공식문서에 적혀있는 전처리 파이프라인은 다음과 같습니다.

저는 EEG 데이터를 전처리 할 때 주로 re-referencing, band pass filter, epoching만 하기 때문에 보다 자세한 설명은 공식문서 [EEG Preprocessing in EEGLAB](https://sccn.ucsd.edu/githubwiki/files/eeglab2019_aspet_artifact_and_ica.pdf)을 참고해주실 바랍니다.   

![EEGLAB](https://cdn.jsdelivr.net/gh/HayoonSong/Images-for-Github-Pages/study/eeg/2022-08-12-eeglab/preprocessing.PNG?raw=true)   
EEG 데이터 전처리 파이프라인 (Source: [Swartz Center for Computational Neuroscience](https://sccn.ucsd.edu/githubwiki/files/eeglab2019_aspet_artifact_and_ica.pdf)
{:.figure}   

### Importing a dataset

***

EEG data를 불러옵니다. 예제 데이터로 수면 단계 분류를 위한 수면다원검사(polysomnography, PSG) 데이터셋 [ISRUC-SLEEP Dataset](https://sleeptight.isr.uc.pt/)에서 첫 번째 그룹 데이터셋(Data of Subgroup_1)을 사용하겠습니다.   

앞선 공식문서에서는 File - Import data - Using EEG functions and plugins에서 원하는 파일 확장자로 import 하는 방법을 소개하고 있습니다.   

![Import data 1](https://cdn.jsdelivr.net/gh/HayoonSong/Images-for-Github-Pages/study/eeg/2022-08-12-eeglab/import_1.PNG?raw=true)   
데이터 불러오는 방법 1
{:.figure}   

그러나, **File - Import data - Using the BIOSIG interface**로 불러왔을 때 .eeg, .rec 등 확장자에 제약이 없이 로드가 가능하였기에 저는 주로 이 방법으로 데이터를 불러옵니다.   

![Import data 2](https://cdn.jsdelivr.net/gh/HayoonSong/Images-for-Github-Pages/study/eeg/2022-08-12-eeglab/import_2.PNG?raw=true)   
데이터 불러오는 방법 2
{:.figure}   

예제 데이터 ISRUC는 총 100명의 수면다원검사 데이터가 들어있습니다. 그 중 첫 번째 사람의 데이터(1.rec)를 사용하여 전처리를 해보겠습니다.   

![Select data](https://cdn.jsdelivr.net/gh/HayoonSong/Images-for-Github-Pages/study/eeg/2022-08-12-eeglab/select_data.PNG?raw=true)   
데이터셋 선택
{:.figure}   

![Import data](https://cdn.jsdelivr.net/gh/HayoonSong/Images-for-Github-Pages/study/eeg/2022-08-12-eeglab/import_data.PNG?raw=true)   
데이터셋 선택 후 화면
{:.figure}   

전처리는 MNE에서 하고 단지 MNE에서 파일을 읽을 수 있도록 파일 확장자만 바꾸고 싶다면 바로 extract 하면 됩니다.   

### Extract

***




